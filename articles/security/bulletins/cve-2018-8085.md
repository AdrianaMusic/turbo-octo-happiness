---
title: Auth0 Security Bulletin CVE-2018-8085
description: Security Update for passport-wsfed-saml2 Passport strategy library (CVE-2018-8085)
toc: true
---
# Security Update for passport-wsfed-saml2 Passport Strategy Library

**Published**: March 13, 2018

**CVE number**: CVE-2018-8085

**Credit**: Internal

## Overview

A vulnerability has been discovered in the [passport-wsfed-saml2 library](https://github.com/auth0/passport-wsfed-saml2) affecting versions < `3.0.10`.

:::note
**passport-wsfed-saml2** is a WS-Federation protocol and SAML2 tokens authentication provider for [Passport.js](http://passportjs.org/).
:::

A vulnerability was found in the validation of a SAML signature. The validation doesn't ensure that the "Signature" tag is at the proper location inside an "Assertion" tag. This leads to a signature relocation attack where the attacker can corrupt one field of data while maintaining the signature valid. This could allow an authenticated attacker to "remove" one group from his assertion or corrupt another field of an assertion.

This update addresses the vulnerability by fixing the XPath expression to ensure that "Signature" field is under the appropriate root element.

Patching this vulnerability requires a library upgrade.

## Am I affected?

This vulnerability affected cloud tenants utilizing the **SAMLP Identity Provider Connection** wherein the identity provider either:

- signed SAML response and signed assertion
- did not sign SAML response and signed assertion

No action is required for Auth0 cloud tenants.

The vulnerability scope also extended to those using the [passport-wsfed-saml2 strategy with passport.js](https://github.com/auth0/passport-wsfed-saml2), which requires a library upgrade (see the next section).

## How to fix that?

Developers using the **passport-wsfed-saml2** library need to upgrade to the latest version: `3.0.10`.

Updated packages are available on npm. To ensure delivery of additional bug fixes moving forward, please make sure your `package.json` file is updated to take patch and minor level updates of our libraries.

```text
{
  "dependencies": {
    "passport-wsfed-saml2": "^3.0.10"
  }
}
```

### Will this update impact my users?

No. This fix patches the library that your application runs, but will not impact your users, their current state, or any existing sessions.
